[{"name":"Twistlock Labs - Exec or attach to a pod","_id":1,"type":"kubernetes-audit","script":"jpath(\"stage\") = \"ResponseComplete\" and jpath(\"objectRef.resource\") = \"pods\" and jpath(\"objectRef.subresource\") in (\"exec\",\"attach\") and jpath(\"verb\") = \"create\"","description":"Audit any exec or attach to a pod","message":"Exec or attach to a pod detected","attackTechniques":["execIntoContainer"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Forbidden request","_id":2,"type":"kubernetes-audit","script":"jpath(\"annotations\") contains \"authorization.k8s.io/decision:forbid\"","description":"Audit any unauthorized API requests","message":"Forbidden request detected","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Privileged pod creation","_id":3,"type":"kubernetes-audit","script":"jpath(\"stage\") = \"ResponseComplete\" and jpath(\"objectRef.resource\") = \"pods\" and jpath(\"objectRef.subresource\") = \"\" and jpath(\"verb\") = \"create\" and jpath(\"requestObject.spec.containers\") contains \"privileged:true\"","description":"Audit creation of privileged pods","message":"Privileged pod created","attackTechniques":["privilegedContainer"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Pod created on host network","_id":4,"type":"kubernetes-audit","script":"jpath(\"stage\") = \"ResponseComplete\" and jpath(\"objectRef.resource\") = \"pods\" and jpath(\"objectRef.subresource\") = \"\" and jpath(\"verb\") = \"create\" and jpath(\"requestObject.spec.hostNetwork\") = \"true\"","description":"Audit creation of pods on the host network","message":"Pod created on host network","attackTechniques":["privilegedContainer"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Pod created without security context","_id":5,"type":"kubernetes-audit","script":"jpath(\"stage\") = \"ResponseComplete\" and jpath(\"objectRef.resource\") = \"pods\" and jpath(\"objectRef.subresource\") = \"\" and jpath(\"verb\") = \"create\" and jpath(\"requestObject.spec.securityContext\") = \"\"","description":"Audit creation of pods without security context","message":"Pod created without security context","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Pod created with host file system mount","_id":6,"type":"kubernetes-audit","script":"jpath(\"stage\") = \"ResponseComplete\" and jpath(\"objectRef.resource\") = \"pods\" and jpath(\"objectRef.subresource\") = \"\" and jpath(\"verb\") = \"create\" and jpath(\"requestObject.spec.volumes\") contains \"hostPath\"","description":"Audit creation of pods with host file system mount","message":"Pod created with host file system mount","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Pod created in host process namespace","_id":7,"type":"kubernetes-audit","script":"jpath(\"stage\") = \"ResponseComplete\" and jpath(\"objectRef.resource\") = \"pods\" and jpath(\"objectRef.subresource\") = \"\" and jpath(\"verb\") = \"create\" and jpath(\"requestObject.spec.hostPID\") = \"true\"","description":"Audit creation of pods in host process namespace","message":"Pod created in host process namespace","attackTechniques":["privilegedContainer"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - GKE - exec or attach to a pod","_id":8,"type":"kubernetes-audit","script":"jpath(\"protoPayload.methodName\") = \"io.k8s.core.v1.pods.exec.create\" or jpath(\"protoPayload.methodName\") = \"io.k8s.core.v1.pods.attach.create\"","description":"Audit any exec or attach event to a pod on GKE","message":"Exec or attach to a pod detected on GKE","attackTechniques":["execIntoContainer"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - GKE - Forbidden request","_id":9,"type":"kubernetes-audit","script":"jpath(\"labels\") contains \"authorization.k8s.io/decision:forbid\"","description":"Audit any unauthorized API requests on GKE","message":"Forbidden request detected on GKE","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - GKE - privileged pod creation","_id":10,"type":"kubernetes-audit","script":"jpath(\"protoPayload.methodName\") = \"io.k8s.core.v1.pods.create\" and jpath(\"protoPayload.request.spec.containers\") contains \"privileged:true\"","description":"Audit creation of privileged pods on GKE","message":"Privileged pod created on GKE","attackTechniques":["privilegedContainer"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - GKE - pod created on host network","_id":11,"type":"kubernetes-audit","script":"jpath(\"protoPayload.methodName\") = \"io.k8s.core.v1.pods.create\" and jpath(\"protoPayload.request.spec.hostNetwork\") = \"true\"","description":"Audit creation of pods on the host network on GKE","message":"Pod created on host network on GKE","attackTechniques":["privilegedContainer"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - GKE - pod created without security context","_id":12,"type":"kubernetes-audit","script":"jpath(\"protoPayload.methodName\") = \"io.k8s.core.v1.pods.create\" and jpath(\"protoPayload.request.spec.securityContext\") = \"\"","description":"Audit creation of pods without security context on GKE","message":"Pod created without security context on GKE","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - GKE - pod created with host file system mount","_id":13,"type":"kubernetes-audit","script":"jpath(\"protoPayload.methodName\") = \"io.k8s.core.v1.pods.create\" and jpath(\"protoPayload.request.spec.volumes\") contains \"hostPath\"","description":"Audit creation of pods with host file system mount on GKE","message":"Pod created with host file system mount on GKE","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - GKE - pod created in host process namespace","_id":14,"type":"kubernetes-audit","script":"jpath(\"protoPayload.methodName\") = \"io.k8s.core.v1.pods.create\" and jpath(\"protoPayload.request.spec.hostPID\") = \"true\"","description":"Audit creation of pods in host process namespace on GKE","message":"Pod created in host process namespace on GKE","attackTechniques":["privilegedContainer"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - User creation (Container)","_id":15,"type":"processes","script":"proc.name = \"useradd\" or (proc.name = \"perl\" and proc.cmdline contains \"adduser\") or (proc.name = \"busybox\" and proc.cmdline startswith \"adduser\")","description":"Detect user creation","message":"User management by %proc.name, user: %proc.user, command: %proc.cmdline","attackTechniques":["createAccount"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - User modification (Container)","_id":16,"type":"processes","script":"proc.name = \"usermod\" or (proc.name = \"perl\" and proc.cmdline contains \"usermod\")","description":"Detect user modification","message":"User management by %proc.name, user: %proc.user, command: %proc.cmdline","attackTechniques":["accountManipulation"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - User deletion (Container)","_id":17,"type":"processes","script":"proc.name = \"userdel\" or (proc.name = \"perl\" and (proc.cmdline contains \"userdel\" or proc.cmdline contains \"deluser\")) or (proc.name = \"busybox\" and proc.cmdline startswith \"deluser\")","description":"Detect user deletion","message":"User management by %proc.name, user: %proc.user, command: %proc.cmdline","attackTechniques":["accountAccessRemoval"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Suspicious networking tool","_id":18,"type":"processes","script":"proc.name in (\"nc.openbsd\", \"nc\", \"ncat\", \"nmap\", \"socat\")","description":"Detect launching of suspicious networking tool","message":"Suspicious networking tool %proc.name was launched by %proc.user","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Suspicious networking scanning tool","_id":19,"type":"processes","script":"proc.name = \"nmap\"","description":"Detect launching of suspicious networking scanning tool","message":"Suspicious networking tool %proc.name was launched by %proc.user","attackTechniques":["networkServiceScanning"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Database app spawned process","_id":20,"type":"processes","script":"proc.pname in (\"mysql\", \"sqlplus\", \"postgres\") and proc.name != proc.pname","description":"A database server app spawned a new process other than itself","message":"Database process %proc.pname spawned %proc.name process","attackTechniques":["applicationExploitRCE","exploitationOfRemoteServices"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Running cron app","_id":21,"type":"processes","script":"proc.name in (\"crontab\", \"cron\", \"anacron\")","description":"Detect an execution of cron app","message":"Cron app %proc.name was executed by %proc.user","attackTechniques":["scheduledTaskJob"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Configuration file changes (Container)","_id":22,"type":"filesystem","script":"file.path startswith \"/etc\"","description":"Detect file writes under /etc folder","message":"%proc.name wrote to %file.path","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Configuration file changes (Host)","_id":23,"type":"filesystem","script":"proc.user != \"root\" and proc.interactive and file.path startswith \"/etc\"","description":"Detect file writes under /etc folder","message":"%proc.name wrote to %file.path, user: %proc.user","owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Linux user management files","_id":24,"type":"filesystem","script":"file.path in (\"/etc/shadow\", \"/etc/passwd\")","description":"Detect writes to linux password and shadow files","message":"%file.path was modified by %proc.user","attackTechniques":["createAccount","accountManipulation"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Bash shell tampering","_id":25,"type":"filesystem","script":"file.path contains \".profile\" or file.path contains \".bashrc\" or file.path contains \".bash_logout\" or file.path contains \".bash_profile\" or file.path contains \".bash_login\" or file.path = \"/etc/profile\"","description":"Detect attempts to tamper with bash shell configuration","message":"%proc.user attempted to tamper with bash shell configuration (%file.path)","attackTechniques":["eventTriggeredExecution"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Cloud platform metadata API access (Container)","_id":26,"type":"network-outgoing","script":"net.outgoing_ip = \"169.254.169.254\" or net.outgoing_ip = \"169.254.170.2\"","description":"Detect access to cloud platform metadata APIs (AWS/GCP/Azure)","message":"Cloud platform metadata API %net.outgoing_ip was accessed by %proc.name","attackTechniques":["cloudInstanceMetadataAPI"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Common crypto mining pool ports","_id":27,"type":"network-outgoing","script":"net.outgoing_port in (3333, 4444, 5555, 6666, 7777, 3347, 14444, 14433, 56415) and not net.private_subnet","description":"Detect access to common crypto miner pool ports","message":"Crypto miner %proc.name accessed pool %net.outgoing_ip:%net.outgoing_port","attackTechniques":["resourceHijacking"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Common data exfiltration ports","_id":28,"type":"network-outgoing","script":"net.outgoing_port in (22, 21, 69)","description":"Detect usage of common data exfiltration ports","message":"Data was potentially transferred to: %net.outgoing_ip:%net.outgoing_port by %proc.name","attackTechniques":["exfiltrationGeneral"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Running privileged process within container","_id":29,"type":"processes","script":"proc.name in (\"docker\", \"kubectl\", \"openshift\", \"oc\")","description":"Detect privileged management tools starting in a container","message":"Privileged process %proc.name spawned in a container","attackTechniques":["softwareDeploymentTools"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - Tampering with Twistlock configuration","_id":30,"type":"kubernetes-audit","script":"jpath(\"objectRef.namespace\") = \"twistlock\" and not jpath(\"verb\") in (\"get\", \"list\", \"watch\") and not jpath(\"objectRef.resource\") in (\"pods\", \"events\")","description":"Audit changes to Twistlock objects, such as the Defender daemonset","message":"Suspicious changes to Twistlock objects detected","attackTechniques":["impairDefences"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Twistlock Labs - GKE - Tampering with Twistlock configuration","_id":31,"type":"kubernetes-audit","script":"jpath(\"protoPayload.resourceName\") contains \"namespaces/twistlock/\" and not jpath(\"protoPayload.authenticationInfo.principalEmail\") startswith \"system:\" and not jpath(\"protoPayload.methodName\") contains \"pods\"","description":"Audit changes to Twistlock objects, such as the Defender daemonset on GKE","message":"Suspicious changes to Twistlock objects detected on GKE","attackTechniques":["impairDefences"],"owner":"system","modified":1672757577,"minVersion":"","vulnIDs":[]}
,{"name":"Client-Side Template Injection","_id":32,"type":"waas-request","script":"req.body_param_values contains /(?i){{(?:\\n|\\r\\n?|.)*?[^\\w\\d\\s-,:_]+(?:\\n|\\r\\n?|.)*?}}/\nor\nreq.query_param_values contains /(?i){{(?:\\n|\\r\\n?|.)*?[^\\w\\d\\s-,:_]+(?:\\n|\\r\\n?|.)*?}}/\nor\nreq.header_values contains /(?i){{(?:\\n|\\r\\n?|.)*?[^\\w\\d\\s-,:_]+(?:\\n|\\r\\n?|.)*?}}/","description":"Client Side Template Injection","message":"Client Side Template Injection","owner":"system","modified":1645037308,"minVersion":"21.08.525","vulnIDs":[]}
,{"name":"CVE-2021-39226","_id":33,"type":"waas-request","script":"req.http_method = \"DELETE\" and urlPathDecode(req.path) contains /api\\/snapshots\\/:key/ or\nreq.http_method = \"GET\" and \n(\nurlPathDecode(req.path) contains /api\\/snapshots\\/:key/\nor\nurlPathDecode(req.path) contains /api\\/snapshots-delete\\/:deleteKey/ \nor\nurlPathDecode(req.path) contains /dashboard\\/snapshot\\/:key/ \n)","description":"CVE-2021-39226 - Grafana Snapshot authentication bypass","message":"CVE-2021-39226 exploitation attempt ","owner":"system","modified":1672660871,"minVersion":"22.01.839","vulnIDs":["CVE-2021-39226"]}
,{"name":"CVE-2022-26138","_id":34,"type":"waas-request","script":"req.http_method = \"POST\" and urlPathDecode(req.path) contains /dologin\\.action/ and urlQueryDecode(req.body) contains /disabled(?:1)?system(?:1)?user(?:6708)?/","description":"CVE-2022-26168 - Confluence authentication bypass","message":"CVE 2022 26168 exploitation attempt","owner":"system","modified":1670323270,"minVersion":"22.01.839","vulnIDs":["CVE-2022-26168"]}
,{"name":"CVE-2022-27925","_id":35,"type":"waas-request","script":"req.http_method = \"POST\" and urlPathDecode(req.path) contains /(?i)service[\\\\\\/.]*?extension[\\\\\\/.]*?backup[\\\\\\/.]*?mboximport/ and req.body contains /^PK.*?\\.\\.\\//","description":"CVE-2022-27925 - Zimbra RCE","message":"CVE 2022 27925 exploitation attempt","owner":"system","modified":1670323264,"minVersion":"22.01.839","vulnIDs":["CVE-2022-27925"]}
,{"name":"CVE-2022-33891","_id":36,"type":"waas-request","script":"req.http_method = \"GET\" and urlQueryDecode(req.query_params[\"doAs\"]) contains /[\\x60\\;\\|\\\u0026\\x0A\\\u003c\\\u003e]|\\$\\(.*?\\)/","description":"CVE-2022-33891 - Apache Spark RCE","message":"CVE-2022-33891 exploitation attempt","owner":"system","modified":1670323256,"minVersion":"22.01.839","vulnIDs":["CVE-2022-33891"]}
,{"name":"CVE-2022-35914","_id":37,"type":"waas-request","script":"req.http_method = \"POST\" and urlPathDecode(req.path) contains /vendor\\/htmlawed\\/htmLawedTest\\.php/ \nand req.headers[\"Cookie\"] contains /sid/\nand urlQueryDecode(req.body_param_names) contains /token/ \nand urlQueryDecode(req.body_param_names) contains /text/ \nand urlQueryDecode(req.body_param_names) contains /hhook/ \nand urlQueryDecode(req.body_param_names) contains /sid/","description":"CVE-2022-35914 - GLPI Project RCE","message":"CVE-2022-35914 exploitation attempt","owner":"system","modified":1672661150,"minVersion":"22.01.839","vulnIDs":["CVE-2022-35914"]}
,{"name":"Double Free in http.sys Remote Code Execution","_id":38,"type":"waas-request","script":"req.headers[\"Accept-Encoding\"] contains /(?i)[\\w\\s]*?,[\\w\\s\\r\\n]*?\\\u0026[\\w\\s\\r\\n]*?\\\u0026\\*\\*[\\w\\s\\r\\n]*?\\**?[\\w\\s\\r\\n]*?,[\\w\\s\\r\\n]*?,[\\w\\s\\r\\n]*?,[\\w\\s\\r\\n]*?,[\\*\\w\\s\\r\\n]*?,[\\*\\w\\s\\r\\n]*?,[\\*\\w\\s\\r\\n]*?,/","description":"CVE-2022-21907, For unpatched Windows Server 2019, Windows Server 2022, Windows 10, Windows 11","message":"Windows http.sys Double Free Remote Code Execution","owner":"system","modified":1670323247,"minVersion":"21.08.525","vulnIDs":["CVE-2022-21907"]}
,{"name":"Drupalgeddon2 - Drupal 7.x \u003c 7.58, 8.3.x \u003c 8.3.9, 8.4.x \u003c 8.4.6, 8.5.x \u003c 8.5.1 CMS RCE","_id":39,"type":"waas-request","script":"req.body contains /(?i)(?:\\[|%5B)?(#|%23)(submit|validate|pre_render|post_render|element_validate|after_build|value_callback|process|access_callback|lazy_builder|type|markup|value|options)(?:\\]|%5D)?/\nor\nreq.body_param_values contains /(?i)(?:\\[|%5B)?(#|%23)(submit|validate|pre_render|post_render|element_validate|after_build|value_callback|process|access_callback|lazy_builder|type|markup|value|options)(?:\\]|%5D)?/\nor\nreq.query_param_names contains /(?i)(?:\\[|%5B)?(#|%23)(submit|validate|pre_render|post_render|element_validate|after_build|value_callback|process|access_callback|lazy_builder|type|markup|value|options)(?:\\]|%5D)?/\nor\nreq.query_param_values contains /(?i)(?:\\[|%5B)?(#|%23)(submit|validate|pre_render|post_render|element_validate|after_build|value_callback|process|access_callback|lazy_builder|type|markup|value|options)(?:\\]|%5D)?/ \nor\nreq.cookie_names contains /(?i)(?:\\[|%5B)?(#|%23)(submit|validate|pre_render|post_render|element_validate|after_build|value_callback|process|access_callback|lazy_builder|type|markup|value|options)(?:\\]|%5D)?/\nor\nreq.header_names contains /(?i)(?:\\[|%5B)?(#|%23)(submit|validate|pre_render|post_render|element_validate|after_build|value_callback|process|access_callback|lazy_builder|type|markup|value|options)(?:\\]|%5D)?/","description":"CVE-2018-7600","message":"Drupalgeddon2 Drupal CMS RCE","owner":"system","modified":1670323239,"minVersion":"21.08.525","vulnIDs":["CVE-2018-7600"]}
,{"name":"Log4Shell - CVE-2021-44228","_id":40,"type":"waas-request","script":"req.path contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.header_names contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.header_values contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.query_param_names contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.query_param_values contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.body_param_values contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.body contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.cookie_names contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.cookie_values contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.http_method contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.http_scheme contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/\nor\nreq.http_version contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|%7d))/","description":"CVE-2021-44228, Apache Log4j2 \u003c 2.15.0","message":"Apache Log4j2 Remote Code Execution","owner":"system","modified":1670323231,"minVersion":"21.08.525","vulnIDs":["CVE-2021-44228"]}
,{"name":"Log4Shell - CVE-2021-45046","_id":41,"type":"waas-request","script":"req.path contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/\nor\nreq.header_names contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/\nor\nreq.header_values contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/\nor\nreq.query_param_names contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/\nor\nreq.query_param_values contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/\nor\nreq.body_param_values contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/\nor\nreq.body contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/\nor\nreq.http_method contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/\nor\nreq.http_version contains /(?i)(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)\\s*?(jndi\\s*?(?:\\:|\\%3a)|(?:\\$|\\%24)\\s*?(?:\\{|\\%7b)[\\s\\S]*?(?:\\}|\\%7d)|[jndi]*?(?:\\$|\\%24)(?:\\{|\\%7d)(?:(?:lower:|upper:)|(?:.*?:)*?(?:-[jndi]?|(?:\\}|\\%7d))))/","description":"CVE-2021-45046, Apache Log4j2 \u003c 2.16.0","message":"Apache Log4j2 Remote Code Execution","owner":"system","modified":1670323220,"minVersion":"21.08.525","vulnIDs":["CVE-2021-45046"]}
,{"name":"Microsoft Exchange 2013, 2016, 2019 Arbitrary File Write","_id":42,"type":"waas-request","script":"req.body contains /(?i)(?:inetpub\\W*wwwroot\\W*aspnet_client\\W*|Microsoft\\W*Exchange\\WServer\\W*v15|Exchange\\W*FrontEnd\\W*HttpProxy)/\nor\nreq.body contains /(?i)JsonDictionaryOfanyType:#Microsoft.Exchange\\.Management\\.ControlPanel[\\S\\s]*(?:ExternalUrl|InternalUrl)/\nor\n(req.body contains /(?i)OABVirtualDirectory[\\S\\s]*msExchEcpCanary/\nor\nreq.header_values contains /(?i)OABVirtualDirectory[\\S\\s]*msExchEcpCanary/)","description":"ProxyLogon/HAFNIUM RCE Attack Chain CVE-2021-26858, CVE-2021-27065","message":"Remote Code Exectution or Webshell Upload against Exchange target","owner":"system","modified":1670323184,"minVersion":"21.08.525","vulnIDs":["CVE-2021-26858","CVE-2021-27065"]}
,{"name":"Microsoft Exchange 2013, 2016, 2019 Unauthenticated SSRF Attack","_id":43,"type":"waas-request","script":"req.path contains /(?i)(?:owa\\Wauth|ecp).*(?:\\.axd|\\.crx|\\.css|\\.eot|\\.gif|\\.jpg|\\.js|\\.htm|\\.html|\\.ico|\\.manifest|\\.mp3|\\.msi|\\.png|\\.svg|\\.ttf|\\.wav|\\.woff|\\.bin|\\.dat|\\.exe|\\.flt|\\.mui|\\.xap|\\.skin)/\nand\nreq.header_values contains /(?i)(?:X-BEResource=[^;]*\\~\\d|X-AnonResource-Backend=[^;]*~\\d)/","description":"ProxyLogon/HAFNIUM RCE Attack Chain CVE-2021-26855","message":"SSRF attack against Exchange target, injection matched cookie: %req.cookies","owner":"system","modified":1670323170,"minVersion":"21.08.525","vulnIDs":["CVE-2021-26855"]}
,{"name":"MS15-034 Microsoft IIS DoS or RCE via Range Header Integer Overflow","_id":44,"type":"waas-request","script":"req.headers[\"Range\"] contains /(?i)bytes[\\S\\s]*-[\\S\\s]*\\d{16,}/","description":"CVE-2015-1635","message":"Integer Overflow against IIS server","owner":"system","modified":1670323160,"minVersion":"21.08.525","vulnIDs":["CVE-2015-1635"]}
,{"name":"Nginx PHP-FPM Remote Code Execution","_id":45,"type":"waas-request","script":"req.path contains /(?i)\\.php.*PHP_VALUE\\s./\nand\n(req.query_param_values contains /.{600,}/\nor req.query_param_names contains /.{600,}/)","description":"CVE-2019-11043","message":"Request from IP: %req.ip tried to execute PHP buffer underflow payload: %req.path","owner":"system","modified":1670323153,"minVersion":"21.04.439","vulnIDs":["CVE-2019-11043"]}
,{"name":"OctocberCMS User Hijacking via Weak Password Reset Mechanism","_id":46,"type":"waas-request","script":"req.path contains /(?i)\\/backend\\/backend\\/auth\\/reset\\/\\d*/\nand\nreq.headers[\"Content-Type\"] contains /(?i)application\\s*?\\/\\s*?json/\nand\nreq.body contains /(?i).code.\\s*:\\s*true/","description":"CVE-2021-32648, OctoberCMS \u003c v1.1.5 Authentication Bypass","message":"OctoberCMS Authentication Bypass","owner":"system","modified":1670323145,"minVersion":"21.08.525","vulnIDs":["CVE-2021-32648"]}
,{"name":"OGNL Evaluation Injection","_id":47,"type":"waas-request","script":"req.path contains /(?i)[%$]\\{(\\S|\\s)*?(?:(\\S|\\s)*?java\\.lang\\.Process(\\S|\\s)*?|(\\S|\\s)*?java\\.lang\\.Runtime(\\S|\\s)*?|(\\S|\\s)*?utility\\.Execute(\\S|\\s)*?|(\\.|\\s)*?exec(\\S|\\s)*?)\\}/\nor\nreq.header_names contains /(?i)[%$]\\{(\\S|\\s)*?(?:(\\S|\\s)*?java\\.lang\\.Process(\\S|\\s)*?|(\\S|\\s)*?java\\.lang\\.Runtime(\\S|\\s)*?|(\\S|\\s)*?utility\\.Execute(\\S|\\s)*?|(\\.|\\s)*?exec(\\S|\\s)*?)\\}/\nor\nreq.header_values contains /(?i)[%$]\\{(\\S|\\s)*?(?:(\\S|\\s)*?java\\.lang\\.Process(\\S|\\s)*?|(\\S|\\s)*?java\\.lang\\.Runtime(\\S|\\s)*?|(\\S|\\s)*?utility\\.Execute(\\S|\\s)*?|(\\.|\\s)*?exec(\\S|\\s)*?)\\}/\nor\nreq.body contains /(?i)[%$]\\{(\\S|\\s)*?(?:(\\S|\\s)*?java\\.lang\\.Process(\\S|\\s)*?|(\\S|\\s)*?java\\.lang\\.Runtime(\\S|\\s)*?|(\\S|\\s)*?utility\\.Execute(\\S|\\s)*?|(\\.|\\s)*?exec(\\S|\\s)*?)\\}/\nor\nreq.body_param_values contains /(?i)[%$]\\{(\\S|\\s)*?(?:(\\S|\\s)*?java\\.lang\\.Process(\\S|\\s)*?|(\\S|\\s)*?java\\.lang\\.Runtime(\\S|\\s)*?|(\\S|\\s)*?utility\\.Execute(\\S|\\s)*?|(\\.|\\s)*?exec(\\S|\\s)*?)\\}/\nor\nreq.query_param_names contains /(?i)[%$]\\{(\\S|\\s)*?(?:(\\S|\\s)*?java\\.lang\\.Process(\\S|\\s)*?|(\\S|\\s)*?java\\.lang\\.Runtime(\\S|\\s)*?|(\\S|\\s)*?utility\\.Execute(\\S|\\s)*?|(\\.|\\s)*?exec(\\S|\\s)*?)\\}/\nor\nreq.query_param_values contains /(?i)[%$]\\{(\\S|\\s)*?(?:(\\S|\\s)*?java\\.lang\\.Process(\\S|\\s)*?|(\\S|\\s)*?java\\.lang\\.Runtime(\\S|\\s)*?|(\\S|\\s)*?utility\\.Execute(\\S|\\s)*?|(\\.|\\s)*?exec(\\S|\\s)*?)\\}/","description":"Apache Struts 2.0.0 - 2.5.25 Remote Code Execution CVE-2020-17530, CVE-2019-0230, CVE-2018-11776, CVE-2017-5638, CVE-2016-4461, CVE-2016-0785, CVE-2013-2135, CVE-2013-2134, CVE-2022-26134","message":"Illegal OGNL evaluation","owner":"system","modified":1670323137,"minVersion":"21.08.525","vulnIDs":["CVE-2020-17530","CVE-2019-0230","CVE-2018-11776","CVE-2017-5638","CVE-2016-4461","CVE-2016-0785","CVE-2013-2135","CVE-2013-2134","CVE-2022-26134"]}
,{"name":"OpenLiteSpeed Remote Code Execution","_id":48,"type":"waas-request","script":"urlPathDecode(req.path) contains \"confMgr.php\"\nand\nurlQueryDecode(req.body) contains /(?i)path\\s*?=\\s*?(?:\\/[\\w*?]*?)*?\\/(?:c(?:h(?:eck_(?:s(?:tatusfile|sl_cert)|by_ssh|memory|cups|raid|log)|oom)|o(?:w(?:think|say)|m(?:poser|m)|lumn|bc)|p(?:ulimit|an|io)?|u(?:psfilter|rl|t)|s(?:vtool|plit|h)|a(?:ncel|psh|t)|r(?:ontab|ash)|ertbot|dist|89|99|mp)|s(?:t(?:art-stop-daemon|r(?:ings|ace)|dbuf)|c(?:r(?:een|ipt|ot)|anmem|p)|s(?:h(?:-keyscan|pass)?)?|e(?:rvice|tarch|d)|o(?:elim|cat|rt)|mbclient|qlite3|ysctl|plit|ash|ftp|huf|lsh|g)|r(?:e(?:d(?:carpet)?|adelf|stic|v)|u(?:n-(?:mailcap|parts)|by)|pm(?:verify|query|db)?|l(?:ogin|wrap)|vi(?:ew|m)|sync|ake)|t(?:a(?:sk(?:s(?:et|h))?|il|c|r)|i(?:me(?:datectl|out)?|c)|c(?:pdump|lsh)|e(?:lnet|e|x)|m(?:ate|ux)|shark|roff|ftp|bl|op)|a(?:s(?:cii(?:-xfr|85)|pell|h)?|nsible-playbook|r(?:ia2c|j|p)?|pt(?:-get)?|t(?:obm)?|lpine|wk|b)|l(?:wp-(?:download|request)|o(?:g(?:inctl|save)|ok)|ua(?:latex|tex)?|atex(?:mk)?|trace|ess|ftp|p)|p(?:d(?:f(?:latex|tex)|b)|i(?:dstat|co?|p)|s(?:ftp|ql)|a(?:ste|x)|er[fl]|uppet|ython|ry?|hp|tx|g)|m(?:sg(?:c(?:onv|at)|attrib|filter|merge|uniq)|a(?:il|ke|wk|n)|o(?:squitto|re)|ultitime|ysql|tr)|g(?:e(?:ni(?:soimage|e)|m)|i(?:nsh|mp|t)|c(?:ore|c)|r(?:ep|c)|tester|hci?|awk|zip|db)|b(?:as(?:e(?:32|58|64|nc|z)|h)|u(?:s(?:ybox|ctl)|ndler?)|ridge|yebug|zip2)|n(?:a(?:no|sm|wk)|o(?:hup|de)|m(?:ap)?|eofetch|senter|roff|ice|ft|pm|c|l)|d(?:i(?:alog|ff|g)|o(?:cker|sbox)|a(?:sh|te)|mesg|vips|pkg|d)|e(?:x(?:p(?:and|ect)|iftool)?|asy_install|macs|nv|qn|b|d)|x(?:e(?:latex|tex)|mo(?:dmap|re)|dotool|args|pad|xd|z)|f(?:i(?:n(?:ger|d)|le|sh)|acter|lock|ping|old|mt|tp)|v(?:i(?:m(?:diff)?|rsh|ew)?|olatility|algrind)|j(?:o(?:urnalctl|in)|runscript|tag|js|q)|u(?:u(?:decode|encode)|n(?:expand|iq)|l)|h(?:e(?:xdump|ad)|ighlight|ping3|d)|z(?:s(?:oelim|h)|athura|ypper|ip)|i(?:onice|spell|conv|ftop|rb|p)|w(?:h(?:iptail|ois)|get|ish|c)|k(?:s(?:shell|h)|ubectl|nife)|o(?:pen(?:ssl|vpn)|ctave|d)|Shell(?:unshare|watch)|y(?:a(?:rn|sh)|elp|um))(?:\\s|\\$|$)/","description":"CVE-2022-0072, CVE-2022-0073, CVE-2022-0074","message":"OpenLiteSpeed Remote Code Execution","owner":"system","modified":1670323079,"minVersion":"22.01.839","vulnIDs":["CVE-2022-0072","CVE-2022-0073","CVE-2022-0074"]}
,{"name":"ProxyShell","_id":49,"type":"waas-request","script":"urlPathDecode(req.path) contains /(?i)autodiscover.*?autodiscover\\.json/ and (req.headers[\"Cookie\"] contains /(?i)Email=autodiscover.*?autodiscover\\.json/ or req.query_params[\"Email\"] contains /(?i)autodiscover.*?autodiscover\\.json/)","description":"CVE-2021-34473","message":"SSRF attack against Exchange target","owner":"system","modified":1670323065,"minVersion":"22.01.839","vulnIDs":["CVE-2021-34473"]}
,{"name":"SpringShell","_id":50,"type":"waas-request","script":"urlQueryDecode(unicodeDecode(compressWhitespace(req.header_names))) contains /(?i)(?:extends\\s*?ClassLoader\\s*?\\{|Base64\\.getDecoder\\s*?\\(|java\\.io\\.InputStream|java\\.lang\\.Process\\s*?\\(|java\\.lang\\.Runtime\\s*?\\(|utility\\.Execute\\s*?\\(|\\.getRuntime\\s*?\\(\\s*?\\)|\\.getInputStream\\s*?\\(|ProcessBuilder\\s*\\(\\s*\\)|\\.newSingleThreadExecutor\\s*?\\(\\))((.|\\s)*?\\.exec\\s*?\\()?/\nor\nurlQueryDecode(unicodeDecode(compressWhitespace(req.header_values))) contains /(?i)(?:extends\\s*?ClassLoader\\s*?\\{|Base64\\.getDecoder\\s*?\\(|java\\.io\\.InputStream|java\\.lang\\.Process\\s*?\\(|java\\.lang\\.Runtime\\s*?\\(|utility\\.Execute\\s*?\\(|\\.getRuntime\\s*?\\(\\s*?\\)|\\.getInputStream\\s*?\\(|ProcessBuilder\\s*\\(\\s*\\)|\\.newSingleThreadExecutor\\s*?\\(\\))((.|\\s)*?\\.exec\\s*?\\()?/\nor\nurlQueryDecode(unicodeDecode(compressWhitespace(req.body))) contains /(?i)(?:extends\\s*?ClassLoader\\s*?\\{|Base64\\.getDecoder\\s*?\\(|java\\.io\\.InputStream|java\\.lang\\.Process\\s*?\\(|java\\.lang\\.Runtime\\s*?\\(|utility\\.Execute\\s*?\\(|\\.getRuntime\\s*?\\(\\s*?\\)|\\.getInputStream\\s*?\\(|ProcessBuilder\\s*\\(\\s*\\)|\\.newSingleThreadExecutor\\s*?\\(\\))((.|\\s)*?\\.exec\\s*?\\()?/\nor\nurlQueryDecode(unicodeDecode(compressWhitespace(req.body_param_values))) contains /(?i)(?:extends\\s*?ClassLoader\\s*?\\{|Base64\\.getDecoder\\s*?\\(|java\\.io\\.InputStream|java\\.lang\\.Process\\s*?\\(|java\\.lang\\.Runtime\\s*?\\(|utility\\.Execute\\s*?\\(|\\.getRuntime\\s*?\\(\\s*?\\)|\\.getInputStream\\s*?\\(|ProcessBuilder\\s*\\(\\s*\\)|\\.newSingleThreadExecutor\\s*?\\(\\))((.|\\s)*?\\.exec\\s*?\\()?/\nor\nurlQueryDecode(unicodeDecode(compressWhitespace(req.query_param_names))) contains /(?i)(?:extends\\s*?ClassLoader\\s*?\\{|Base64\\.getDecoder\\s*?\\(|java\\.io\\.InputStream|java\\.lang\\.Process\\s*?\\(|java\\.lang\\.Runtime\\s*?\\(|utility\\.Execute\\s*?\\(|\\.getRuntime\\s*?\\(\\s*?\\)|\\.getInputStream\\s*?\\(|ProcessBuilder\\s*\\(\\s*\\)|\\.newSingleThreadExecutor\\s*?\\(\\))((.|\\s)*?\\.exec\\s*?\\()?/\nor\nurlQueryDecode(unicodeDecode(compressWhitespace(req.query_param_values))) contains /(?i)(?:extends\\s*?ClassLoader\\s*?\\{|Base64\\.getDecoder\\s*?\\(|java\\.io\\.InputStream|java\\.lang\\.Process\\s*?\\(|java\\.lang\\.Runtime\\s*?\\(|utility\\.Execute\\s*?\\(|\\.getRuntime\\s*?\\(\\s*?\\)|\\.getInputStream\\s*?\\(|ProcessBuilder\\s*\\(\\s*\\)|\\.newSingleThreadExecutor\\s*?\\(\\))((.|\\s)*?\\.exec\\s*?\\()?/","description":"CVE-2022-22963, CVE-2022-22965, CVE-2022-42889","message":"SpringShell Remote Code Execution","owner":"system","modified":1671105885,"minVersion":"22.01.839","vulnIDs":["CVE-2022-22963","CVE-2022-22965"]}
,{"name":"WordPress \u003c= 4.9.2 DoS via load-scripts or load-styles","_id":51,"type":"waas-request","script":"req.path contains /(?i)load-(?:scripts|styles)\\.php/\nand\nreq.query_param_names contains /(?i)load\\[\\]/\nand\nreq.query_params[\"load[]\"] contains /[\\S\\s]{100,}/","description":"CVE-2018-6389","message":"DoS attack against WordPress target","owner":"system","modified":1670323011,"minVersion":"21.08.525","vulnIDs":["CVE-2018-6389"]}
]